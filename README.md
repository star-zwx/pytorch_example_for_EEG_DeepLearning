## é€‚ç”¨äºè„‘ç”µä¿¡å·ç«¯åˆ°ç«¯æ·±åº¦å­¦ä¹ æ¨¡å‹è®­ç»ƒçš„pytorchæ¡†æ¶
> åˆ›å»ºæ—¥æœŸï¼š2025å¹´4æœˆ17æ—¥
> ä½œè€…ï¼šwanxin

```C++
/*
é¡¹ç›®æ–‡ä»¶ç»“æ„
å·¥ä½œè·¯å¾„ï¼š./pytorch_example
--ğŸ“‚checkpoint
    ->best_model_repeat1-20250417_173703.pth  ï¼šæ¯ä¸€æ¬¡å®éªŒä¿å­˜çš„æ€§èƒ½æœ€å¥½çš„æ¨¡å‹
    Â·Â·Â·
--ğŸ“‚configs
    ->model_config.json  :è®­ç»ƒè¿‡ç¨‹ä¸­çš„è¶…å‚æ•°è®¾ç½®ï¼Œä¸€èˆ¬ä¸è¦æ›´æ”¹å…¶ç»“æ„ï¼Œå¯ä»¥å¤åˆ¶å¤šä»½åœ¨main.pyä¸­å¡«å†™ç›¸åº”è·¯å¾„
--ğŸ“‚dataset
    ->ğŸ“‚dataname1
    ->ğŸ“‚dataname2 ï¼šå¯ä»¥æ˜¯å¤šä¸ªæ•°æ®é›†ï¼Œæ–‡ä»¶å¤¹ä»¥æ•°æ®é›†åç§°å‘½åï¼Œæ•°æ®é›†åç§°å¯ä»¥åœ¨jsonæ–‡ä»¶ä¸­é…ç½®
        ->ğŸ“‚S1
        ->ğŸ“‚S2
        ->ğŸ“‚S3  :è¢«è¯•æ–‡ä»¶å¤¹ï¼Œå¯ä»¥æœ‰å¤šä¸ªè¢«è¯•ï¼Œå¦‚æœæ˜¯è¢«è¯•ç‹¬ç«‹å®éªŒéœ€è¦åœ¨jsonæ–‡ä»¶ä¸­é…ç½®éœ€è¦é’ˆå¯¹å“ªä¸ªè¢«è¯•å®éªŒ
            ->ğŸ“‚session1 
            ->ğŸ“‚session2 ï¼šæ¯ä¸ªè¢«è¯•å¯ä»¥æœ‰å¤šæ¬¡å®éªŒï¼Œå¦‚æœåªæœ‰ä¸€æ¬¡å®éªŒï¼Œå°±åªç•™ä¸€ä¸ªæ–‡ä»¶å¤¹å°±è¡Œ
                ->ğŸ“„sample_0.npy
                ->ğŸ“„sample_1.npy
                ...
                ->ğŸ“„sample_10.npy  :è¯¥è¢«è¯•çš„ä¸€æ¬¡å®éªŒåŒ…å«å¤šä¸ªtrailsï¼Œæ¯ä¸ªtrailsä¿å­˜ä¸ºä¸€ä¸ªnpyæ–‡ä»¶ï¼Œnpyæ–‡ä»¶çš„æ ¼å¼åé¢ä»‹ç»    
--ğŸ“‚logs
    ->ğŸ“‚EEGNet-20250417_174017 :è®­ç»ƒè¿‡ç¨‹çš„æ•°æ®ä¿å­˜çš„æ–‡ä»¶å¤¹ï¼Œå‘½åè§„åˆ™æ˜¯ï¼Œæ¨¡å‹å_æ—¥æœŸ_æ—¶é—´
        ->ğŸ“„logs.json  ï¼šè®­ç»ƒè¿‡ç¨‹çš„å…·ä½“æ•°æ®ä¿å­˜ä¸ºjsonæ ¼å¼çš„æ–‡ä»¶
--ğŸ“‚models
    ->ğŸ“‚model_name 
    ->ğŸ“‚EEGNet  :ä¸åŒæ¨¡å‹ä¿å­˜åœ¨ä¸åŒæ–‡ä»¶å¤¹ä¸­ï¼Œå¯ä»¥åœ¨jsonæ–‡ä»¶ä¸­é…ç½®é€‰æ‹©çš„æ¨¡å‹åç§°
        ->ğŸ“„EEGNet.py  :å…·ä½“çš„æ¨¡å‹çš„ç±» 
--ğŸ“‚out  ï¼šå¯ä»¥è‡ªå·±åœ¨è¯¥æ–‡ä»¶å¤¹ä¸­ä¿å­˜ä¸€ç‚¹è‡ªå·±æƒ³è¦çš„ç»“æœï¼Œä»£ç ä¸ä¼šæ“ä½œè¯¥æ–‡ä»¶å¤¹
--ğŸ“‚picture  ï¼šå¯ä»¥è‡ªå·±åœ¨è¯¥æ–‡ä»¶å¤¹ä¸­ä¿å­˜ä¸€ç‚¹è‡ªå·±æƒ³è¦çš„ç»“æœï¼Œä»£ç ä¸ä¼šæ“ä½œè¯¥æ–‡ä»¶å¤¹
--ğŸ“‚utils
    ->ğŸ“„dataset.py : å£°æ˜äº†EEGDatasetç±»ï¼Œç»§æ‰¿äºpytorchçš„Datasetç±»ï¼Œç”¨æ¥è¯»å–æ ·æœ¬æ•°æ®
    ->ğŸ“„datasplit.py ï¼šå°†æ•°æ®æŒ‰ç…§ä¸€å®šæ¯”ä¾‹éšæœºåˆ’åˆ†ä¸ºè®­ç»ƒé›†/æµ‹è¯•é›†/éªŒè¯é›†ï¼Œåˆ’åˆ†æ¯”ä¾‹å¯ä»¥åœ¨jsonæ–‡ä»¶ä¸­é…ç½®
    ->ğŸ“„drawData.py ï¼šå£°æ˜äº†ç»˜å›¾çš„ç±»ï¼Œå…·ä½“é£Ÿç”¨æ–¹æ³•ä¼šåœ¨ç¤ºä¾‹ä»£ç ä¸­ä»‹ç»
    ->ğŸ“„read_json.py ï¼šè¯»å–jsonæ–‡ä»¶çš„å‡½æ•°
    ->ğŸ“„save_json.py ï¼šä¿å­˜jsonæ–‡ä»¶çš„å‡½æ•°
--ğŸ“„main.py  ï¼šç¨‹åºå…¥å£ï¼Œé‡Œé¢ä¼šæœ‰ç¨‹åºçš„ä½¿ç”¨ç¤ºä¾‹
--ğŸ“„ModelTrainer.py  ï¼šæ¨¡å‹è®­ç»ƒçš„é€»è¾‘ï¼Œä»¥ç±»çš„å½¢å¼å‘ˆç°ï¼Œå¯ä»¥ä¾›å¤§å®¶è‡ªè¡Œå†™ç±»ç»§æ‰¿


*/
```
>æ³¨æ„ï¼šæ¨¡å‹çš„åç§°å’Œå…·ä½“çš„ç±»çš„å¯¹åº”å…³ç³»ï¼Œéœ€è¦åœ¨ModelTrainer.pyä¸­çš„ç¬¬50è¡Œä¿®æ”¹
#### è¶…å‚æ•°é…ç½®æ–‡ä»¶è¯´æ˜
```json
{
  "model_name": "å¡«å†™æ¨¡å‹åç§°ï¼Œéœ€è¦å’Œæ¨¡å‹æ–‡ä»¶å¤¹åŒå",   
  "data_name" : "å¡«å†™æ•°æ®é›†åç§°ï¼Œéœ€è¦å’Œæ•°æ®é›†æ–‡ä»¶å¤¹åŒå",
  "data_root_path" : ".\\dataset\\",
  "save_logs_path": "./logs/",
  "save_model_path": "./checkpoint/",
  "learning_rate": "åˆå§‹å­¦ä¹ ç‡",
  "batch_size": "batch_size",
  "epochs": 50,
  "repeat_time": "10ï¼šè¿™ä¸ªæ˜¯æ¨¡å‹è®­ç»ƒçš„æ¬¡æ•°ï¼Œæ¯ä¸€æ¬¡éƒ½æ˜¯ä»å¤´å¼€å§‹",
  "optimizer": "Adam:ä¼˜åŒ–å™¨ï¼Œç›®å‰åªå†™å…¥äº†è¿™ä¸€ç§ï¼Œå¦‚éœ€æ·»åŠ å¯ä»¥åœ¨ModelTrainer.pyçš„initialize_optimizerå‡½æ•°ä¸­æ·»åŠ ",
  "dropout_rate": 0.5,
  "activation_function": "ReLUï¼šæ²¡ä»€ä¹ˆç”¨ï¼Œè¿˜å¾—å–å†³äºä½ å…·ä½“æ¨¡å‹ä¸­ç”¨çš„å•¥ï¼Œä¸æ”¹ä¹Ÿè¡Œ",
  "loss_function": "CrossEntropyLossï¼šç›®å‰åªå†™å…¥äº†è¿™ä¸€ç§ï¼Œå¦‚éœ€æ·»åŠ å¯ä»¥åœ¨ModelTrainer.pyçš„initialize_losså‡½æ•°ä¸­æ·»åŠ ",
  "early_stopping": { 
    "Enable": "yesï¼šæ—©åœç­–ç•¥ï¼Œè¿˜æ²¡åœ¨è®­ç»ƒä¸­å…·ä½“å®ç°ï¼Œå¦‚éœ€è¦å¯ä»¥ä½¿ç”¨",
    "monitor": "val_loss",
    "patience": 10,
    "restore_best_weights": true
  },
  "learning_rate_decay": "yesï¼šå­¦ä¹ ç‡è¡°å‡ç­–ç•¥ï¼Œä¹Ÿæ²¡åœ¨è®­ç»ƒä¸­å®ç°ï¼Œå…·ä½“å¯ä»¥è‡ªå·±è‡ªå®šä¹‰",
  "init_seed": 42,
  "data_split:æ•°æ®åˆ’åˆ†çš„æ¯”ä¾‹": { 
    "train":0.8,
    "test": 0.1,
    "val": 0.1
  },

  "Subject_sigalï¼šè¢«è¯•ç‹¬ç«‹å®éªŒçš„ï¼Œéœ€è¦å¡«å†™æ˜¯åœ¨å“ªä¸ªè¢«è¯•ä¸Šå®éªŒ": {
    "sigal": "yes",
    "subject_name": "S1"
  }




}

```
#### npyæ•°æ®æ ¼å¼è¯´æ˜:''data':è„‘ç”µæ•°æ®ï¼ˆå¯¼è”æ•°*é‡‡æ ·ç‚¹æ•°ï¼‰ï¼Œ''label'ï¼šæ ‡ç­¾
```json
{'data': array([[ 0.73422146,  1.0643618 , -0.8760664 , ..., -0.6761451 ,
         1.6069859 ,  0.7272754 ],
       [ 1.7815675 ,  0.09552965,  0.21665184, ..., -0.31801918,
        -0.73996896, -0.6138159 ],
       [-1.0974427 , -0.7658083 , -0.26736796, ...,  0.0575758 ,
        -2.2482195 ,  0.24907291],
       ...,
       [ 0.48023748, -0.7256806 , -0.0512979 , ..., -0.38112995,
        -0.17092532, -1.173531  ],
       [-1.2511326 , -1.093581  , -1.772579  , ...,  0.8940185 ,
         2.4616046 , -0.23252268],
       [-0.907785  ,  0.2658302 ,  0.69808334, ..., -0.01930626,
        -0.8922807 , -0.67896014]], dtype=float32), 'label': 0}
```
#### 4.22å¢åŠ äº†webç«¯ä¾¿æ·ç»˜å›¾ï¼Œä»¥åä¼šé€æ­¥å®Œå–„ç»†èŠ‚åŠŸèƒ½
åœ¨æ–‡ä»¶å¤¹ ğŸ“‚htmlDrawä¸­ï¼Œè¿è¡Œindex.html
![img.png](images/img.png)
ç‚¹å‡»é€‰æ‹©æ–‡ä»¶å¯åŠ è½½è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ•°æ®ï¼Œéœ€è¦åŒºåˆ†äº¤å‰éªŒè¯å’Œéäº¤å‰éªŒè¯ï¼Œä¸Šä¼ æ–‡ä»¶åä¼šæ˜¾ç¤ºä¸€äº›æ€»ä½“ä¿¡æ¯
æŸå¤±å‡½æ•°é¡µé¢ï¼šå¯ä»¥é€‰æ‹©ç»˜åˆ¶å“ªæ¬¡å®éªŒå’Œå“ªä¸ªæŠ˜çš„æ•°æ®ç»˜åˆ¶
![img_1.png](images/img_1.png)
æ€»ä½“ä¿¡æ¯åŒ…æ‹¬å››ç§ï¼Œä¹Ÿéœ€è¦é€‰æ‹©å“ªæ¬¡å®éªŒå“ªä¸ªæŠ˜
![img_2.png](images/img_2.png)
#### 4.20å¢åŠ äº†KæŠ˜äº¤å‰éªŒè¯çš„è®­ç»ƒé€»è¾‘
```json

"Cross_validation" : {
    "selection": "yes",
    "Fload_Num": 5
  }
```
é€šè¿‡å¡«å†™Fload_Numçš„å€¼ï¼Œæ§åˆ¶Kçš„å€¼
ç›®å‰é€šè¿‡KæŠ˜äº¤å‰éªŒè¯çš„è®­ç»ƒæ•°æ®æ— æ³•ç»˜å›¾ï¼Œæ­£åœ¨å¼€å‘webç«¯äº¤äº’å¼å›¾è¡¨ç»˜åˆ¶


